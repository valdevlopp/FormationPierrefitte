* On considère une entreprise (bdd) de ventes de voitures.

* Un modèle de voiture (table = marque) est décrit par une
marque, une dénomination. Une voiture est identifiée par un numéro de série, (colonnes) et a un modèle, (colonnes)
une
couleur (colonnes) et un prix affiché (colonnes) et un coût (colonnes) (prix auquel la voiture est revenue) (colonnes).

* Des clients (table), dont on connaı̂t le nom, le prénom et l’adresse. (colonnes)

Parmi les clients, on trouve les anciens propriétaires des voitures
d’occasion, ainsi que les personnes ayant acheté une voiture au magasin.

* Lorsqu’une vente est réalisée, on en connaı̂t le vendeur (table) (dont on connaı̂t le nom (colonne -> table
vendreur), le prénom (colonne -> table vendeur), l’adresse (colonne -> table vendeur) et le salaire fixe (colonne ->
table vendeur)
et le prix d’achat réel (en tenant compte d’un rabais éventuel). Chaque vendeur touche une prime
de 5% de la différence entre le prix d’achat affiché et le coût de la voiture.

* L’entreprise est répartie
sur un certain nombre de magasins (table) et chaque vendeur opère dans un magasin unique. Chaque
voiture est, ou à été, stockée dans certains magasins et est vendue dans le dernier magasin où elle
a été stockée. On garde trace des dates d’arrivée dans et de départ des magasins. Un transfert de
voiture entre deux magasins se fait dans la journée.

1. Donner un diagramme Entité/Association pour représenter ces données
2. Donner un schéma de base de données correspondant à ce diagramme
3. Écrire les requêtes suivantes en SQL:
Donner la liste des voitures (numéro) vendues après le 15 avril 2007.
Donner la voiture qui à rapporté le plus d'argent
Donner le vendeur ayant accordé le plus gros rabais.
Les bénéfices de chaque magasin pour le mois de janvier 2007.
Le meilleur client (celui ayant rapporté le plus d’argent à l’entreprise).
La marque pour laquelle on a accordé le plus de rabais.

Réduire